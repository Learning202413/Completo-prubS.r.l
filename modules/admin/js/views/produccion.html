<header class="flex items-center justify-between pb-6 border-b border-gray-200 mb-6">
    <div class="flex items-center">
        <button id="sidebar-toggle" class="mr-4 p-2 rounded-full hover:bg-gray-200 text-gray-600 transition">
            <i data-lucide="menu" class="w-6 h-6"></i>
        </button>
        <h1 class="text-3xl font-bold text-gray-800">Control de Producción (Asignación)</h1>
    </div>
    <span class="text-sm text-gray-500">Módulo: Admin</span>
</header>

<p class="text-gray-500 mb-6">Arrastre una OT de una columna 'Pendiente' a 'Asignado' para abrir el modal de asignación.</p>

<div id="kanban-container" class="kanban-container">
    
    <div id="column-preprensa-pendiente" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="pre-prensa">
        <div class="bg-red-500 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="edit-3" class="w-5 h-5 inline mr-2"></i> Pre-Prensa Pendiente</span>
            <span class="text-sm font-bold bg-white text-red-500 px-2 py-0.5 rounded-full" id="count-pre-prensa-pendiente">2</span>
        </div>
        <div class="space-y-3 flex-grow overflow-y-auto min-h-[50px] max-h-[70vh] pr-1" data-status="pendiente">
             <div data-ot-id="OT-1234" draggable="true" class="kanban-card p-4 rounded-xl shadow-lg border-l-4 border-yellow-400 cursor-grab bg-white">
                 <p class="font-bold text-gray-800">OT-1234</p>
                 <p class="text-sm text-gray-500">Industrias Gráficas</p>
                 <p class="text-sm text-gray-700 mt-1">1000 Revistas A4</p>
             </div>
        </div>
    </div>

    <div id="column-diseno-asignado" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="diseno">
        <div class="bg-yellow-500 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="user-check" class="w-5 h-5 inline mr-2"></i> En Diseño Asignado</span>
            <span class="text-sm font-bold bg-white text-yellow-500 px-2 py-0.5 rounded-full" id="count-diseno-asignado">1</span>
        </div>
         <div class="space-y-3 flex-grow overflow-y-auto pr-1" data-status="asignado">
             <div data-ot-id="OT-1235" draggable="false" class="kanban-card p-4 rounded-xl shadow-lg border-l-4 border-yellow-400 cursor-default bg-white">
                 <p class="font-bold text-gray-800">OT-1235</p>
                 <p class="text-sm text-gray-500">Editorial Futuro</p>
                 <p class="text-sm text-gray-700 mt-1">500 Libros</p>
                 <p class="text-xs font-bold text-blue-600 mt-2 pt-2 border-t">Asignado a: Carlos Ruiz</p>
             </div>
        </div>
    </div>
    
    <div id="column-listo-prensa" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="listo-prensa">
        <div class="bg-green-600 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="printer" class="w-5 h-5 inline mr-2"></i> Listo para Prensa</span>
            <span class="text-sm font-bold bg-white text-green-600 px-2 py-0.5 rounded-full" id="count-listo-prensa">1</span>
        </div>
        <div class="space-y-3 flex-grow overflow-y-auto pr-1" data-status="pendiente">
             <div data-ot-id="OT-1236" draggable="true" class="kanban-card p-4 rounded-xl shadow-lg border-l-4 border-green-400 cursor-grab bg-white">
                 <p class="font-bold text-gray-800">OT-1236</p>
                 <p class="text-sm text-gray-500">Publicaciones XYZ</p>
                 <p class="text-sm text-gray-700 mt-1">1000 Plegables</p>
             </div>
        </div>
    </div>
    
    <div id="column-prensa-asignado" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="prensa">
        <div class="bg-blue-600 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="settings" class="w-5 h-5 inline mr-2"></i> En Prensa Asignado</span>
            <span class="text-sm font-bold bg-white text-blue-600 px-2 py-0.5 rounded-full" id="count-prensa-asignado">0</span>
        </div>
        <div class="space-y-3 flex-grow overflow-y-auto pr-1" data-status="asignado"></div>
    </div>

    <div id="column-listo-acabados" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="listo-acabados">
        <div class="bg-teal-500 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="scissors" class="w-5 h-5 inline mr-2"></i> Listo para Acabados</span>
            <span class="text-sm font-bold bg-white text-teal-500 px-2 py-0.5 rounded-full" id="count-listo-acabados">0</span>
        </div>
        <div class="space-y-3 flex-grow overflow-y-auto pr-1" data-status="pendiente"></div>
    </div>
    
    <div id="column-postprensa-asignado" class="kanban-column flex flex-col p-3 rounded-lg shadow-xl border border-slate-300/50" data-stage="post-prensa">
        <div class="bg-indigo-500 text-white p-3 rounded-t-lg font-semibold text-lg flex justify-between items-center mb-2 shadow-md">
            <span><i data-lucide="package-check" class="w-5 h-5 inline mr-2"></i> En Post-Prensa</span>
            <span class="text-sm font-bold bg-white text-indigo-500 px-2 py-0.5 rounded-full" id="count-post-prensa-asignado">0</span>
        </div>
        <div class="space-y-3 flex-grow overflow-y-auto pr-1" data-status="asignado"></div>
    </div>

</div>

<!-- Modal para asignación (Contenido que será INYECTADO en el contenedor global por JS) -->
<div id="assign-modal-content" class="hidden">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-xl bg-white">
        <h3 id="assign-modal-title" class="text-xl font-bold mb-4 text-gray-800">Asignar Tarea: OT-####</h3>
        <form id="assign-form" class="space-y-4">
            <input type="hidden" id="assign-ot-id" value="">
            <input type="hidden" id="assign-source-column" value="">
            
            <div>
                <label for="assign-resource" class="block text-sm font-medium text-gray-700">Asignar a Recurso (Diseñador / Operador)</label>
                <select id="assign-resource" class="w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm">
                    <option value="CR">Carlos Ruiz (Diseño)</option>
                    <option value="ER">Elena Ríos (Diseño)</option>
                    <option value="MT">Máquina Offset #3</option>
                    <option value="LP">Luis Pérez (Acabados)</option>
                </select>
            </div>
            <div>
                <label for="assign-datetime" class="block text-sm font-medium text-gray-700">Fecha/Hora Inicio Estimada</label>
                <input type="datetime-local" id="assign-datetime" class="w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg shadow-sm">
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button type="button" onclick="window.UI.hideModal('assign-modal-container')" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Cancelar</button>
                <button type="submit" id="confirm-assign-button" class="px-4 py-2 color-primary-red text-white rounded-lg hover:bg-red-700">Confirmar Asignación</button>
            </div>
        </form>
    </div>
</div>